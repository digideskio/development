<!DOCTYPE html>
<meta charset="utf-8">
<style>
.bar {
  fill: steelblue;
  stroke: none;
}
.selected {
  fill: red;
}
</style>
<body>
<script src="../d3.v2.js"></script>
<script>
var _id_ = 0;
function generate() {
	return { index: _id_++, value: 5 + 95*Math.random() };
}

var data = d3.range(100).map(generate);

var w = 900,
    h = 100,
    bw = 9;

var y = d3.scale.linear().domain([0,100]).range([0,100]);

var svg = d3.select("body").append("svg")
    .attr("width", w)
    .attr("height", h);

svg.selectAll("rect.bar")
    .data(data)
  .enter().append("rect")
    .attr("class", "bar")
    .attr("x", function(d,i) { return i*bw; })
    .attr("width", bw-1)
    .attr("y", function(d) { return h - y(d.value); })
    .attr("height", function(d) { return y(d.value); })
    .on("mouseover", function(d) {
        d3.select(this).classed("selected", true);
    })
    .on("mouseout", function(d) {
        d3.select(this).classed("selected", false);
    });

function update() {
	data.shift(); 
	data.push(generate());
	
    var bars = svg.selectAll("rect.bar")
        .data(data);

    bars.transition()
        .duration(500)
        .attr("x", function(d,i) { return i*bw; })
        .attr("width", bw-1)
        .attr("y", function(d) { return h - y(d.value); })
        .attr("height", function(d) { return y(d.value); });
}

setInterval(update, 2000);

</script>